{% extends "base_layout.html" %}

{% block title %}Admin Dashboard - ParkAlot{% endblock %}
{% block meta_description %}Manage parking lots and users in ParkAlot.{% endblock %}

{% block head_extra %}
    {{ super() }}
    <link rel="stylesheet" href="/static/css/navbar2.css">

    <style>
        .table-container {
            max-height: 500px; 
            overflow-y: auto;  
            border: 1px solid #ddd;
            background: white;
            border-radius: 8px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            outline: black solid 1px;
        }
        .table thead th {
            position: sticky;
            top: 0;
            background: #212529; 
            color: white;
            z-index: 2;
        }
        .btn-sm {
            padding: 4px 10px;
            font-size: 14px;
        }
           
    </style>
{% endblock %}

{% block content %}
    {% include "admin_navbar.html" %}

    <!-- hero -->
    <div class="hero-section">
        <!-- Title -->
        <div class="text-center">
            <h3 class="custom-heading">
                Parking Lots
            </h3>
        </div>

        <!-- parking lots scrollable Table -->
        <div class="table-container mt-3">
        <table class="table table-striped table-hover bg-white shadow-sm rounded">
            <thead class="table-dark">
                <tr>
                    <th scope="col">Lot ID</th>
                    <th scope="col">Area Type</th>
                    <th scope="col">City</th>
                    <th scope="col">Prime Location</th>
                    <th scope="col">Address</th>
                    <th scope="col">Pincode</th>
                    <th scope="col">Price/hr (â‚¹)</th>
                    <th scope="col">Total Spots</th> 
                    <th scope="col">Physically Occupied</th> 
                    <th scope="col">Actions</th>
                </tr>
            </thead>
            <tbody>
                
                {% for lot_stats in lots_with_stats %}
                <tr>
                    <td>{{ lot_stats.lot.lot_id }}</td>
                    <td>{{ lot_stats.lot.area_type }}</td>
                    <td>{{ lot_stats.lot.city }}</td>
                    <td>{{ lot_stats.lot.primelocation_name }}</td>
                    <td>{{ lot_stats.lot.address }}</td>
                    <td>{{ lot_stats.lot.pincode }}</td>
                    <td>{{ lot_stats.lot.price_per_hr }}</td>
                    <td>{{ lot_stats.total_spots }}</td> {# Display total_spots #}
                    <td>{{ lot_stats.occupied_physical_spots }}</td> {# Display occupied_physical_spots #}
                    <td>
                        <a href="{{ url_for('edit_parking', lot_id=lot_stats.lot.lot_id) }}" class="btn btn-sm btn-primary">Edit</a>
                        <a href="{{ url_for('parking_spots', lot_id=lot_stats.lot.lot_id) }}" class="btn btn-sm btn-info">Manage</a> {# Updated button text #}
                        <a href="{{ url_for('delete_parking', lot_id=lot_stats.lot.lot_id) }}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this lot?')">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        </div>

        <!-- add parking lot button -->
        <div class="text-center mt-4">
            <a href="{{ url_for('add_parking') }}" class="btn btn-dark">+ Add New Parking Lot</a>
        </div>
    </div>
{% endblock %}